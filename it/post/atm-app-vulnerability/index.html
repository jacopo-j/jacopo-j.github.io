<!DOCTYPE html>
<html lang="it"><meta charset="utf-8"><meta name="generator" content="Hugo 0.133.1"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>Vulnerabilità nell&#39;app di ATM Milano&nbsp;&ndash;&nbsp;Jacopo Jannone - blog</title><link rel="stylesheet" href="/css/core.min.2dd128fcc709346b49dd1f9b3173e501b3edb153fd8b536ebcaf9a42999da947c3d7beaed80059b93cbb1431ede30089.css" integrity="sha384-LdEo/McJNGtJ3R&#43;bMXPlAbPtsVP9i1NuvK&#43;aQpmdqUfD176u2ABZuTy7FDHt4wCJ"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Vulnerabilità nell&#39;app di ATM Milano" />
<meta name="og:title" content="Vulnerabilità nell&#39;app di ATM Milano" />
<meta name="og:description" content="" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/it/"><span class="site name">Jacopo Jannone - blog</span></a>
            </span>
        <span class="header right-side"><span class="header lang-switcher"><span>it</span><a href="https://blog.jacopo.io/en/post/atm-app-vulnerability/">en</a></span></span></div></section><section id="content"><div class="article-container"><section class="article header"><h1 class="article title">Vulnerabilità nell'app di ATM Milano</h1><p class="article date">18 agosto 2020<span class="langs"><span class="lang"><a href="/en/post/atm-app-vulnerability/">English version</a></span></span></p></section><article class="article markdown-body"><p>Una serie di errori di progettazione nell&rsquo;app di ATM Milano permetteva a chiunque di accedere ai dati e ai biglietti degli utenti semplicemente conoscendone l&rsquo;indirizzo e-mail. Nel frattempo, alcune apparenti misure di sicurezza rendevano le vulnerabilità meno facili da individuare e da sfruttare.</p>
<h2 id="un-po-di-contesto">Un po&rsquo; di contesto</h2>
<p>L&rsquo;app di ATM, disponibile sia per Android<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> sia per iOS<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>, fornisce diverse funzionalità utili per chi usufruisce del servizio di trasporti pubblici di Milano. Per esempio consente di cercare le fermate dei mezzi e di visualizzare il tempo di attesa stimato; ricevere notifiche sulla situazione del traffico; calcolare un itinerario tra due punti di interesse. Ma consente anche di <strong>acquistare biglietti</strong> utilizzabili su tutta la rete dei trasporti milanese pagando via SMS, con carta di credito o tramite PayPal.</p>
<p><img  src="/atm-app-vulnerability/it/image1.png"
        alt="Screenshot app ATM Milano"/></p>
<p>I motivi che hanno portato la mia attenzione su quest&rsquo;app sono piuttosto semplici. Essendo un cliente di ATM, volevo estrapolare e documentare l&rsquo;API per usufruire delle stesse funzioni dell&rsquo;app su piattaforme diverse da quelle previste. Tanto per dare un&rsquo;idea, mi sarebbe piaciuto visualizzare in un widget sul desktop del mio computer il tempo di attesa del tram che passa fuori da casa mia.</p>
<h2 id="analisi-del-traffico">Analisi del traffico</h2>
<p>Come sempre il mio reverse engineering comincia configurando un <strong>proxy HTTPS</strong> sullo smartphone su cui è installata l&rsquo;app per dare una sbirciata al traffico. Spesso in questo modo si ottengono tutte le informazioni che si desiderano e non serve addentrarsi ulteriormente nel funzionamento dell&rsquo;app. Sembrava proprio questo il caso: considerando che l&rsquo;app non dava nemmeno segni della presenza di certificate pinning<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>, contavo di finire il mio lavoro in pochi minuti.</p>
<p>Le richieste prodotte durante il <strong>login nell&rsquo;area riservata</strong> dell&rsquo;app, da cui è possibile acquistare i biglietti, hanno invece attirato la mia attenzione più del previsto. Vediamole insieme.</p>
<h3 id="richiesta-di-login">Richiesta di login</h3>
<p>Innanzitutto l&rsquo;app invia le credenziali al backend, come ci si aspetterebbe.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/v2/it/Membership/ValidateUser</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">ContentType</span><span class="o">:</span> <span class="l">application/json;charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Timestamp</span><span class="o">:</span> <span class="l">Tue, 12 Jun 2018 19:17:42 GMT</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">Android/6.0.1 (Nexus 5) it.atm.appmobile/3.4</span>
</span></span><span class="line"><span class="cl"><span class="n">Authentication</span><span class="o">:</span> <span class="l">ATMApp:5rWm4ttLe4NrB/LbglTFz6+DaQrJUwcHMN2901Caz+s=</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">60</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">atm-be.sg.engitel.com</span>
</span></span><span class="line"><span class="cl"><span class="n">Connection</span><span class="o">:</span> <span class="l">Keep-Alive</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;username&#34;</span><span class="p">:</span> <span class="s2">&#34;jacopo.j@esempio.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;password&#34;</span><span class="p">:</span> <span class="s2">&#34;miapassword&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Il server risponde:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</span></span><span class="line"><span class="cl"><span class="n">Cache-Control</span><span class="o">:</span> <span class="l">no-cache</span>
</span></span><span class="line"><span class="cl"><span class="n">Pragma</span><span class="o">:</span> <span class="l">no-cache</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">1</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Expires</span><span class="o">:</span> <span class="l">-1</span>
</span></span><span class="line"><span class="cl"><span class="n">Server</span><span class="o">:</span> <span class="l">Microsoft-IIS/8.5</span>
</span></span><span class="line"><span class="cl"><span class="n">Request-Context</span><span class="o">:</span> <span class="l">appId=cid-v1:815dcd44-dd4b-45ce-b0e0-cc8a66a1f0c5</span>
</span></span><span class="line"><span class="cl"><span class="n">X-AspNet-Version</span><span class="o">:</span> <span class="l">4.0.30319</span>
</span></span><span class="line"><span class="cl"><span class="n">X-Powered-By</span><span class="o">:</span> <span class="l">ASP.NET</span>
</span></span><span class="line"><span class="cl"><span class="n">Date</span><span class="o">:</span> <span class="l">Tue, 12 Jun 2018 19:17:43 GMT</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mi">0</span>
</span></span></code></pre></div><p>Fin qui non c&rsquo;è quasi nulla di strano. Dico &ldquo;quasi&rdquo; perché nonostante a prima vista sembri tutto in ordine, i lettori più attenti si accorgeranno che nella risposta del server manca qualcosa.</p>
<p>Qualcuno potrebbe anche chiedersi cosa sia quel singolo <code>0</code> che troviamo nel corpo della risposta. Possiamo scoprirlo andando per tentativi e ripetendo il login dall&rsquo;app con credenziali diverse.</p>
<p>Ecco il risultato:</p>
<ul>
<li><code>0</code> è il valore che viene restituito quando il login è completato con successo (come nel caso sopra).</li>
<li><code>1</code> viene restituito quando l&rsquo;username inserito non esiste.</li>
<li><code>4</code> viene restituito quando l&rsquo;username inserito esiste ma la password non è corretta.</li>
</ul>
<p>Il fatto di distinguere il caso in cui un username non esista da quello in cui la password non sia corretta costituisce una scelta progettuale abbastanza curiosa, che sicuramente avrà i suoi motivi. Il fatto che si tratti di una caratteristica intenzionale è confermato dall&rsquo;interfaccia grafica dell&rsquo;app, che mostra due messaggi di errore diversi nei due casi. Ma andiamo avanti.</p>
<h3 id="richiesta-del-wallet">Richiesta del <em>wallet</em></h3>
<p>Ora che siamo loggati l&rsquo;app chiede al server il nostro <em>wallet</em>, ovvero la lista dei biglietti che abbiamo acquistato.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">GET</span> <span class="nn">/v2/it/ticketing/wallet</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">ContentType</span><span class="o">:</span> <span class="l">application/json;charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Timestamp</span><span class="o">:</span> <span class="l">Tue, 12 Jun 2018 19:17:43 GMT</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">Android/6.0.1 (Nexus 5) it.atm.appmobile/3.4</span>
</span></span><span class="line"><span class="cl"><span class="n">Authentication</span><span class="o">:</span> <span class="l">jacopo.j@esempio.com:IlwR5JE3QqBG0WUF8GaergNFC1K9kjZSZZXeFUDdK5U=</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">atm-be.sg.engitel.com</span>
</span></span><span class="line"><span class="cl"><span class="n">Connection</span><span class="o">:</span> <span class="l">Keep-Alive</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip</span>
</span></span></code></pre></div><p>Nel momento in cui ho registrato questa richiesta il mio portafoglio conteneva solo un biglietto urbano non ancora utilizzato.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</span></span><span class="line"><span class="cl"><span class="n">Cache-Control</span><span class="o">:</span> <span class="l">no-cache</span>
</span></span><span class="line"><span class="cl"><span class="n">Pragma</span><span class="o">:</span> <span class="l">no-cache</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">951</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Expires</span><span class="o">:</span> <span class="l">-1</span>
</span></span><span class="line"><span class="cl"><span class="n">Server</span><span class="o">:</span> <span class="l">Microsoft-IIS/8.5</span>
</span></span><span class="line"><span class="cl"><span class="n">Request-Context</span><span class="o">:</span> <span class="l">appId=cid-v1:815dcd44-dd4b-45ce-b0e0-cc8a66a1f0c5</span>
</span></span><span class="line"><span class="cl"><span class="n">X-AspNet-Version</span><span class="o">:</span> <span class="l">4.0.30319</span>
</span></span><span class="line"><span class="cl"><span class="n">X-Powered-By</span><span class="o">:</span> <span class="l">ASP.NET</span>
</span></span><span class="line"><span class="cl"><span class="n">Date</span><span class="o">:</span> <span class="l">Tue, 12 Jun 2018 19:43:44 GMT</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;MobileTicketId&#34;</span><span class="p">:</span> <span class="s2">&#34;PXSL9GUUH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;ValidationTimeStamp&#34;</span><span class="p">:</span> <span class="s2">&#34;1997-01-01T00:00:00&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;ExpirationTimeStamp&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;QrCodeData&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;ValidationGuid&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Description_ENG&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Description_IT&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Duration&#34;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Price&#34;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;TariffId&#34;</span><span class="p">:</span> <span class="mi">2095</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;MaxValidationsAllowed&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Description&#34;</span><span class="p">:</span> <span class="s2">&#34;Biglietto Singolo Urbano&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Instruction&#34;</span><span class="p">:</span> <span class="s2">&#34;Biglietto valido per un viaggio della durata di 90 minuti sia sui mezzi ATM che sulle tratte urbane della rete ferroviaria di Trenord, Passante Ferroviario compreso. Convalida sempre prima di accedere ai mezzi. Usa il QR code per entrare in metropolitana dai tornelli segnalati, oppure stampa il biglietto ai distributori automatici usando il PNR. Biglietto valido per una sola corsa in metropolitana. Per accedere ai tratti urbani di Trenord è sempre necessario stampare il titolo di viaggio. Non valido per RHO Fieramilano&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DurationDescription&#34;</span><span class="p">:</span> <span class="s2">&#34;90&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Duration_IT&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Duration_ENG&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Instruction_IT&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Instruction_ENG&#34;</span><span class="p">:</span> <span class="kc">null</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></div><h3 id="un-header-un-sospetto-una-vulnerabilità">Un header, un sospetto, una vulnerabilità</h3>
<p>Se finora non avete notato alcuna mancanza, e se menzionare i cookie ancora non vi fa suonare un campanello d&rsquo;allarme, riguardate le richieste chiedendovi come venga mantenuta una <strong>sessione</strong> tra le varie richieste <em>stateless</em>. Oppure, più esplicitamente: come fa il server ad assicurarsi che gli utenti possano richiedere solo il proprio <em>wallet</em>?</p>
<p>Considerando che in nessuna richiesta c&rsquo;è traccia di un cookie o di qualche altro tipo di token che identifichi una sessione, l&rsquo;unica parvenza di sicurezza sembra essere nell&rsquo;header <code>Authentication</code> che l&rsquo;app invia a ogni richiesta.</p>
<p>È facile vedere che l&rsquo;header è costituito da due parti separate da due punti (<code>:</code>). La prima parte contiene l&rsquo;username dell&rsquo;utente loggato – oppure <code>ATMApp</code> se l&rsquo;utente non si è ancora loggato, come si vede nella <a href="#richiesta-di-login" >richiesta di login</a>. La seconda parte contiene dei dati codificati in base64 che cambiano a ogni richiesta.</p>
<p>Pur non conoscendo il significato dei dati nella seconda parte dell&rsquo;header, una domanda sorge spontanea: cosa succede se <strong>modifichiamo la richiesta</strong> (per esempio usando gli strumenti del proxy) sostituendo il nostro username con quello di qualcun altro?</p>
<p>Ho deciso di provarci. Ho spiegato a un mio collega costa stavo facendo; gli ho chiesto di comprare un biglietto con il suo account e mi sono fatto dare l&rsquo;indirizzo e-mail con cui era registrato. Ho configurato il proxy per fare un rewrite dell&rsquo;header <code>Authorization</code> e ho ripetuto la <a href="#richiesta-del-wallet" >richiesta del <em>wallet</em></a> sostituendo il mio indirizzo e-mail con il suo.</p>
<p>Incredibilmente, il server ha eseguito senza lamentarsi e mi ha restituito il <em>wallet</em> del mio collega, con il biglietto appena acquistato. Notate il <code>MobileTicketId</code> (o PNR<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>) del biglietto diverso dal mio.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</span></span><span class="line"><span class="cl"><span class="n">Cache-Control</span><span class="o">:</span> <span class="l">no-cache</span>
</span></span><span class="line"><span class="cl"><span class="n">Pragma</span><span class="o">:</span> <span class="l">no-cache</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">951</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Expires</span><span class="o">:</span> <span class="l">-1</span>
</span></span><span class="line"><span class="cl"><span class="n">Server</span><span class="o">:</span> <span class="l">Microsoft-IIS/8.5</span>
</span></span><span class="line"><span class="cl"><span class="n">Request-Context</span><span class="o">:</span> <span class="l">appId=cid-v1:815dcd44-dd4b-45ce-b0e0-cc8a66a1f0c5</span>
</span></span><span class="line"><span class="cl"><span class="n">X-AspNet-Version</span><span class="o">:</span> <span class="l">4.0.30319</span>
</span></span><span class="line"><span class="cl"><span class="n">X-Powered-By</span><span class="o">:</span> <span class="l">ASP.NET</span>
</span></span><span class="line"><span class="cl"><span class="n">Date</span><span class="o">:</span> <span class="l">Tue, 12 Jun 2018 20:32:12 GMT</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;MobileTicketId&#34;</span><span class="p">:</span> <span class="s2">&#34;E57C41F19&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;ValidationTimeStamp&#34;</span><span class="p">:</span> <span class="s2">&#34;1997-01-01T00:00:00&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;ExpirationTimeStamp&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;QrCodeData&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;ValidationGuid&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Description_ENG&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Description_IT&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Duration&#34;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Price&#34;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;TariffId&#34;</span><span class="p">:</span> <span class="mi">2095</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;MaxValidationsAllowed&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Description&#34;</span><span class="p">:</span> <span class="s2">&#34;Biglietto Singolo Urbano&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Instruction&#34;</span><span class="p">:</span> <span class="s2">&#34;Biglietto valido per un viaggio della durata di 90 minuti sia sui mezzi ATM che sulle tratte urbane della rete ferroviaria di Trenord, Passante Ferroviario compreso. Convalida sempre prima di accedere ai mezzi. Usa il QR code per entrare in metropolitana dai tornelli segnalati, oppure stampa il biglietto ai distributori automatici usando il PNR. Biglietto valido per una sola corsa in metropolitana. Per accedere ai tratti urbani di Trenord è sempre necessario stampare il titolo di viaggio. Non valido per RHO Fieramilano&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;DurationDescription&#34;</span><span class="p">:</span> <span class="s2">&#34;90&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Duration_IT&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Duration_ENG&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Instruction_IT&#34;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;Instruction_ENG&#34;</span><span class="p">:</span> <span class="kc">null</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span></code></pre></div><p>A questo punto ho deciso che la cosa andava approfondita studiando anche il significato della seconda parte dell&rsquo;header <code>Authorization</code>.</p>
<h3 id="garanzie-di-integrità">Garanzie di integrità?</h3>
<p>Innanzitutto mi sono accorto che la lunghezza dei dati è di 256 bit, fissa, cosa che mi ha fatto subito pensare a un hash SHA-256. Poi, notando che tra gli header inviati dall&rsquo;app c&rsquo;è anche un <code>Timestamp</code>, ho riconosciuto il pattern dell&rsquo;autenticazione tramite <strong>HMAC</strong><sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup>. Semplificando, alcune parti <em>critiche</em> della richiesta vengono concatenate con il timestamp attuale e con una chiave segreta condivisa tra client e server. Un hash del risultato viene quindi inviato al server insieme con la richiesta.</p>
<p>Il server, prima di elaborarla, può concatenare gli stessi elementi e calcolare lo stesso hash. Se l&rsquo;hash corrisponde a quello inviato dal client, l&rsquo;<strong>integrità</strong> dei dati coinvolti è garantita. Se modifichiamo le parti <em>critiche</em> della richiesta il server otterrà un hash diverso da quello fornito dal client, rileverà la manomissione e rifiuterà la richiesta. Il timestamp entra in gioco per evitare che una richiesta possa essere ripetuta a distanza di un certo numero di minuti (o secondi).</p>
<p>Purtroppo non esiste uno standard che definisca le parti <em>critiche</em> della richiesta da includere nel calcolo dell&rsquo;HMAC. Per ora sappiamo solo che l&rsquo;username dell&rsquo;utente che ha effettuato l&rsquo;accesso sicuramente non è incluso, altrimenti il tentativo di ottenere i biglietti del mio collega non sarebbe andato a buon fine. Per indagare più in profondità dobbiamo decompilare l&rsquo;applicazione.</p>
<h2 id="dentro-lapp"><em>Dentro</em> l&rsquo;app</h2>
<p>Estrarre un&rsquo;app per smartphone, e in particolare un&rsquo;app per Android, è semplice quanto decomprimere un <strong>file zip</strong>. Normalmente userei un tool come <em>jadx</em><sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup> per automatizzare l&rsquo;estrazione del file apk e la decompilazione dell&rsquo;eseguibile, ottenendo una buona approssimazione del codice sorgente dell&rsquo;app in Java.</p>
<p>In questo caso però una rapida occhiata al contenuto del file apk rivela qualcosa di interessante:</p>
<pre tabindex="0"><code>it.atm.appmobile.apk
├── assemblies
│   ├── ATM.dll
│   ├── Microsoft.AppCenter.dll
│   ├── Microsoft.CSharp.dll
│   ├── Mono.Android.dll
│   ├── Mono.Security.dll
│   ├── Xamarin.Android.Arch.Core.Common.dll
│   ├── Xamarin.Android.Support.v4.dll
...
</code></pre><p>Cosa ci fanno dei <strong>file DLL</strong> in un&rsquo;app per Android? La spiegazione è semplice: l&rsquo;app è realizzata con Xamarin<sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup>, un framework di Microsoft che consente di realizzare app cross-platform scritte in C#. Questo significa che i file DLL che abbiamo trovato contengono l&rsquo;intera logica dell&rsquo;applicazione, mentre l&rsquo;eseguibile dell&rsquo;app si limita a costruire l&rsquo;ambiente di runtime di Microsoft .NET.</p>
<p>Questa, in realtà, è un&rsquo;ottima notizia. Gli eseguibili e le librerie prodotte con Microsoft .NET sono notoriamente <strong>facili da decompilare</strong>, e il codice sorgente che si ottiene spesso è talmente fedele all&rsquo;originale da poter essere ricompilato. Inoltre esiste una vasta gamma di software tra cui scegliere, da <em>dotPeek</em><sup id="fnref:8"><a href="#fn:8" class="footnote-ref" role="doc-noteref">8</a></sup> a <em>dnSpy</em><sup id="fnref:9"><a href="#fn:9" class="footnote-ref" role="doc-noteref">9</a></sup>. È sufficiente importare tutti i DLL e il decompilatore fa il resto, sfornando codice estremamente leggibile e fedele all&rsquo;originale.</p>
<h3 id="niente-più-segreti">Niente più segreti</h3>
<p>Curiosando tra i sorgenti ricostruiti, troviamo facilmente il codice che cercavamo.</p>
<p>Ecco la funzione che concatena i parametri della richiesta da includere nel calcolo dell&rsquo;HMAC. I commenti sono stati aggiunti da me.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cs" data-lang="cs"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">string</span> <span class="n">Autentication</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">get</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&#34;{0}\n{1}\n{2}\n{3}&#34;</span><span class="p">,</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[</span><span class="m">4</span><span class="p">]</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="kt">object</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="n">Method</span><span class="p">,</span>              <span class="c1">// Il metodo della richiesta</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="kt">object</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="n">DateUTC</span><span class="p">,</span>             <span class="c1">// Data e ora attuali</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="kt">object</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="n">UriAction</span><span class="p">.</span><span class="n">ToLower</span><span class="p">(),</span> <span class="c1">// Il path della richiesta</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="kt">object</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="n">Parameters</span>           <span class="c1">// La query string</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>E qui c&rsquo;è la funzione che costruisce l&rsquo;hash, prendendo come parametri la chiave &ldquo;segreta&rdquo; condivisa tra client e server e la stringa prodotta con la funzione sopra:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cs" data-lang="cs"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">string</span> <span class="n">ComputeHash</span><span class="p">(</span><span class="kt">string</span> <span class="n">hashedPassword</span><span class="p">,</span> <span class="kt">string</span> <span class="n">message</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">UTF8Encoding</span> <span class="n">utF8Encoding</span> <span class="p">=</span> <span class="k">new</span> <span class="n">UTF8Encoding</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">HMACSHA256</span> <span class="n">hmacshA256</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HMACSHA256</span><span class="p">(</span><span class="n">utF8Encoding</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">hashedPassword</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">    <span class="n">str</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">hmacshA256</span><span class="p">.</span><span class="n">ComputeHash</span><span class="p">(</span><span class="n">utF8Encoding</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">message</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">str</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Ho messo &ldquo;segreta&rdquo; tra virgolette perché la chiave che prende parte al calcolo dell&rsquo;hash è <em>hard-codata</em> nei sorgenti dell&rsquo;applicazione.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cs" data-lang="cs"><span class="line"><span class="cl"><span class="kd">private</span> <span class="kd">const</span> <span class="kt">string</span> <span class="n">AuthenticationHeaderName</span> <span class="p">=</span> <span class="s">&#34;Authentication&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="kd">const</span> <span class="kt">string</span> <span class="n">TimestampHeaderName</span> <span class="p">=</span> <span class="s">&#34;Timestamp&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="kd">const</span> <span class="kt">string</span> <span class="n">ConsumerKey</span> <span class="p">=</span> <span class="s">&#34;ATMApp&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="kd">const</span> <span class="kt">string</span> <span class="n">ConsumerSecret</span> <span class="p">=</span> <span class="s">&#34;jn2ic5az&#34;</span><span class="p">;</span> <span class="c1">// Segreto condiviso</span>
</span></span></code></pre></div><p>Vorrei sottolineare che in ogni caso <strong>non c&rsquo;è nessun modo</strong> di salvare una chiave segreta lato client in modo sicuro. <em>Hard-codarla</em> non è una scelta sbagliata di per sé; anzi, metterla altrove o cercare di offuscarla non avrebbe reso l&rsquo;app più sicura. Avrebbe solo reso più difficile il mio lavoro.</p>
<p>Con queste informazioni anche l&rsquo;unico mistero che rimaneva è risolto. Siamo effettivamente di fronte a un HMAC-SHA256 e tra l&rsquo;altro ora conosciamo tutti gli ingredienti necessari per generare l&rsquo;hash a partire da una <strong>richiesta qualsiasi</strong>. Questo significa che possiamo costruire nuove richieste personalizzandone ogni loro parte (mentre prima l&rsquo;HMAC sconosciuto ci impediva di smanettare con il percorso o con la query string). A prova di ciò ho realizzato un proof of concept che troverete <a href="#il-codice-del-proof-of-concept" >in fondo al post</a>.</p>
<p>A questo punto possiamo tirare le somme sulle vulnerabilità trovate.</p>
<h2 id="le-vulnerabilità">Le vulnerabilità</h2>
<h3 id="lunico-meccanismo-di-sicurezza-è-un-hmac">L&rsquo;unico meccanismo di sicurezza è un HMAC</h3>
<p>Come abbiamo visto l&rsquo;app non tiene traccia di una sessione con il server usando i cookie, come si è soliti fare; implementa invece una sola funzione di sicurezza basata su un <strong>&ldquo;segreto&rdquo; condiviso</strong>. Dato che non è possibile custodire un segreto lato client in maniera sicura, anche l&rsquo;integrità che un HMAC dovrebbe fornire non è garantita. Un utente malintenzionato potrebbe estrarre la chiave segreta e usarla per firmare richieste personalizzate, proprio come abbiamo fatto noi.</p>
<h3 id="limplementazione-dellhmac-non-è-sufficientemente-sicura">L&rsquo;implementazione dell&rsquo;HMAC non è sufficientemente sicura</h3>
<p>I parametri della richiesta che prendono parte alla generazione dell&rsquo;HMAC sono:</p>
<ul>
<li>metodo della richiesta (<code>GET</code>, <code>POST</code>, ecc)</li>
<li>timestamp attuale</li>
<li>path della richiesta (per esempio <code>/v2/it/ticketing/wallet</code>)</li>
<li>query string</li>
</ul>
<p>Siccome il nome dell&rsquo;utente eventualmente autenticato non è tra questi parametri, anche se la <a href="#lunico-meccanismo-di-sicurezza-%c3%a8-un-hmac" >prima vulnerabilità</a> non esistesse sarebbe comunque possibile alterare le richieste per ottenere i dati e i biglietti di altri utenti, altra cosa che abbiamo già fatto.</p>
<p>Dato che con i biglietti il server restituisce anche i relativi PNR, sarebbe possibile per un malintenzionato &ldquo;riscuotere&rdquo; i biglietti di un altro utente semplicemente digitandone il codice in un distributore automatico. Allo stesso modo sarebbe possibile abusare dell&rsquo;API per convalidare il biglietto e ottenere direttamente il codice QR da usare ai tornelli.</p>
<p>Si potrebbe aggiungere anche il fatto che nemmeno il corpo delle richieste POST partecipa alla generazione dell&rsquo;HMAC, lasciando anche altri tipi di richieste senza un adeguato livello di protezione.</p>
<h3 id="la-soluzione">La soluzione</h3>
<p>Le vulnerabilità delineate qui sono state risolte da ATM grazie all&rsquo;uso di JWT<sup id="fnref:10"><a href="#fn:10" class="footnote-ref" role="doc-noteref">10</a></sup>. Nelle versioni dell&rsquo;app attualmente disponibili, l&rsquo;header <code>Authentication</code> per gli utenti che hanno effettuato l&rsquo;accesso non contiene più l&rsquo;username in chiaro accostato all&rsquo;HMAC. Invece, l&rsquo;username è codificato in un token firmato.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">GET</span> <span class="nn">/v3/it/ticketing/wallet</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">atm-be.sg.engitel.com</span>
</span></span><span class="line"><span class="cl"><span class="n">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
</span></span><span class="line"><span class="cl"><span class="n">Authentication</span><span class="o">:</span> <span class="l">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphY29wby5qQGVzZW1waW8uY29tIiwiaXNzIjoiQVRNQkUiLCJhdWQiOiJBVE1BcHAiLCJleHAiOjE1OTk5OTA4MzUsIm5iZiI6MTU5NzM5ODgzNX0=.lLAe3C6UJY3RvNlBrJH3zb5ra70JoILcx_LbeI2bivQ:RmbFP5ZQ5vOwX24DehXTb5iyGRMVQfFr/ueeVRD4jOs=</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">:</span> <span class="l">*/*</span>
</span></span><span class="line"><span class="cl"><span class="n">ContentType</span><span class="o">:</span> <span class="l">application/json;charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">iOS/14.0 (iPhone) it.atm.iATMMilano/7.4.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Timestamp</span><span class="o">:</span> <span class="l">Mon, 17 Aug 2020 13:39:39 GMT</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Language</span><span class="o">:</span> <span class="l">it-it</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate, br</span>
</span></span></code></pre></div><p>Non entrerò nei dettagli delle specifiche di JWT in questa sede. Mi limiterò a notare che il token è costituito da tre parti separate da un punto, e che ogni parte è codificata in base64. La prima parte contiene informazioni sull&rsquo;algoritmo usato per la firma:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;typ&#34;</span><span class="p">:</span> <span class="s2">&#34;JWT&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;alg&#34;</span><span class="p">:</span> <span class="s2">&#34;HS256&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Mentre la seconda contiene l&rsquo;username e alcune informazioni che determinano la validità del token:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;username&#34;</span><span class="p">:</span> <span class="s2">&#34;jacopo.j@esempio.com&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;iss&#34;</span><span class="p">:</span> <span class="s2">&#34;ATMBE&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;aud&#34;</span><span class="p">:</span> <span class="s2">&#34;ATMApp&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;exp&#34;</span><span class="p">:</span> <span class="mi">1599990835</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;nbf&#34;</span><span class="p">:</span> <span class="mi">1597398835</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>La terza parte è invece una firma delle prime due; in questo caso si tratta ancora una volta di HMAC-SHA256. Ma allora cos&rsquo;è cambiato rispetto a prima? Perché questo approccio dovrebbe essere più sicuro? La risposta risiede nel fatto che è il server a restituire il token firmato nel momento in cui il client esegue il login.</p>
<p>Il client non ha quindi <strong>alcuna conoscenza del segreto</strong> usato per la firma; non si tratta più di un segreto condiviso, ma di un segreto noto solo lato server. Diventa così impossibile estrapolarlo e usarlo per firmare richieste personalizzate.</p>
<p>Anche senza introdurre l&rsquo;uso dei cookie, mantenendo quindi un API completamente <em>stateless</em>, è stata introdotta una contromisura efficace per impedire agli utenti di impersonare qualcun altro. L&rsquo;HMAC nella seconda parte dell&rsquo;header <code>Authorization</code> è stato mantenuto, ma ora non ha più la pretesa di proteggere da questo tipo di abusi.</p>
<h3 id="timeline-della-responsible-disclosure">Timeline della <em>responsible disclosure</em></h3>
<ul>
<li><strong>27 maggio 2018</strong>: scopro le vulnerabilità e invio una segnalazione ad ATM.</li>
<li><strong>29 maggio 2018</strong>: vengo contattato da ATM; illustro i problemi da sottoporre agli sviluppatori dell&rsquo;applicazione.</li>
<li><strong>14 giugno 2018</strong>: invio ad ATM un proof of concept che dimostra la possibilità di &ldquo;rubare&rdquo; i biglietti agli altri utenti.</li>
<li><strong>11 luglio 2018</strong>: incontro i dirigenti della divisione Sistemi Informativi di ATM presso la loro sede per discutere ulteriormente delle vulnerabilità.</li>
<li>Durante l&rsquo;<strong>autunno 2018</strong> ATM rilascia un aggiornamento dell&rsquo;applicazione che risolve le vulnerabilità trovate. Gli endpoint vulnerabili lato server vengono però lasciati in esecuzione per retrocompatibilità con le vecchie versioni dell&rsquo;app.</li>
<li>Durante l&rsquo;<strong>estate 2020</strong> gli endpoint vulnerabili vengono rimossi.</li>
<li><strong>11 agosto 2020</strong>: accerto che le vulnerabilità non sono più presenti e che il proof of concept che avevo realizzato non è più funzionante.</li>
<li><strong>18 agosto 2020</strong>: pubblico questo post.</li>
</ul>
<h3 id="il-codice-del-proof-of-concept">Il codice del <em>proof of concept</em></h3>
<p>Insieme a questo post <a href="https://github.com/jacopo-j/atm-vuln-poc" target="_blank">rendo disponibile su GitHub</a> il codice sorgente del <em>proof of concept</em> che ho realizzato per ATM. Si tratta di una singola pagina in PHP che permetteva di sfruttare le vulnerabilità trovate per mostrare la lista dei biglietti di un determinato utente conoscendone solo l&rsquo;indirizzo e-mail. Chiaramente ora che le vulnerabilità sono state risolte, la pagina non è più funzionante. Ritengo però che possa essere interessante per chiunque voglia curiosare in maniera un po&rsquo; più ravvicinata.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://play.google.com/store/apps/details?id=it.atm.appmobile" target="_blank">https://play.google.com/store/apps/details?id=it.atm.appmobile</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p><a href="https://apps.apple.com/it/app/atm-milano-official-app/id415637297" target="_blank">https://apps.apple.com/it/app/atm-milano-official-app/id415637297</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Il certificate pinning, o public key pinning, aggiunge un blando livello di protezione impedendo a eventuali proxy di decodificare le richieste effettuate al backend. <a href="https://security.stackexchange.com/questions/29988/what-is-certificate-pinning" target="_blank">Dettagli</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>Passenger Name Record, costituisce il codice univoco che identifica un determinato titolo di viaggio sulla rete di trasporti.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p><a href="https://security.stackexchange.com/questions/20129/how-and-when-do-i-use-hmac" target="_blank">Informazioni più approfondite su HMAC</a>&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6">
<p><a href="https://github.com/skylot/jadx" target="_blank">https://github.com/skylot/jadx</a>&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7">
<p><a href="https://dotnet.microsoft.com/apps/xamarin" target="_blank">https://dotnet.microsoft.com/apps/xamarin</a>&#160;<a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:8">
<p><a href="https://www.jetbrains.com/decompiler/" target="_blank">https://www.jetbrains.com/decompiler/</a>&#160;<a href="#fnref:8" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:9">
<p><a href="https://github.com/0xd4d/dnSpy" target="_blank">https://github.com/0xd4d/dnSpy</a>&#160;<a href="#fnref:9" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:10">
<p><a href="https://jwt.io" target="_blank">https://jwt.io</a>&#160;<a href="#fnref:10" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div></article><section class="article labels"><a class="tag" href=/it/tags/atmmilano/>atmmilano</a><a class="tag" href=/it/tags/app/>app</a><a class="tag" href=/it/tags/zeroday/>zeroday</a></section>



<style>
#share-buttons {display: inline-block; vertical-align: middle; }
#share-buttons:after {content: ""; display: block; clear: both;}
#share-buttons > div {
position: relative;
text-align: left; 
height: 36px; 
width: 32px; 
float: left; 
text-align: center;
}
#share-buttons > div > svg {height: 16px; fill: #d5d5d5; margin-top: 10px;}
#share-buttons > div:hover {cursor: pointer;}
#share-buttons > div.twitter:hover > svg {fill: #55ACEE;}
#share-buttons > div.linkedin:hover > svg {fill: #0077b5;}
#share-buttons > div.mail:hover > svg {fill: #7D7D7D;}
#share-buttons > div.twitter > svg {height: 20px; margin-top: 8px;}
#share-buttons > div.linkedin > svg {height: 19px; margin-top: 7px;}
#share-buttons > div.mail > svg {height: 14px; margin-top: 11px;}
</style>

<div>
<span style="color: silver">Condividi post: </span><div id="share-buttons">
<div class="twitter" title="Twitter" onclick="window.open('https://twitter.com/intent/tweet?text=https%3A%2F%2Fblog.jacopo.io%2Fit%2Fpost%2Fatm-app-vulnerability%2F%20%E2%80%93%20by%20%40jacopoj_');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div>
<div class="linkedin" title="Linkedin" onclick="window.open('https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fblog.jacopo.io%2Fit%2Fpost%2Fatm-app-vulnerability%2F');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg></div>
<div class="mail" title="E-mail" onclick="window.open('mailto:?body=https%3A%2F%2Fblog.jacopo.io%2Fit%2Fpost%2Fatm-app-vulnerability%2F');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1792 710v794q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-794q44 49 101 87 362 246 497 345 57 42 92.5 65.5t94.5 48 110 24.5h2q51 0 110-24.5t94.5-48 92.5-65.5q170-123 498-345 57-39 100-87zm0-294q0 79-49 151t-122 123q-376 261-468 325-10 7-42.5 30.5t-54 38-52 32.5-57.5 27-50 9h-2q-23 0-50-9t-57.5-27-52-32.5-54-38-42.5-30.5q-91-64-262-182.5t-205-142.5q-62-42-117-115.5t-55-136.5q0-78 41.5-130t118.5-52h1472q65 0 112.5 47t47.5 113z"/></svg></div>
</div>
</div>
</div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/it/post/apple-ocsp/"><span class="iconfont icon-article"></span>È vero che Apple traccia ogni app che apri? Uno sguardo tecnico</a></p><p><a class="link" href="/it/post/trenitalia-reverse-engineering/"><span class="iconfont icon-article"></span>Reverse engineering dell'app di Trenitalia</a></p></section></div></section><section id="footer">
    <div class="footer-wrap"><div class="details social-links"><a class="item" href="https://github.com/jacopo-j" target="_blank"><span class="iconfont icon-github"></span>&nbsp;jacopo-j</a><a rel="me" class="item" href="https://infosec.exchange/@jacopo" target="_blank"><span class="iconfont icon-mastodon"></span>&nbsp;@jacopo@infosec.exchange</a><a class="item" href="https://twitter.com/jacopoj_" target="_blank"><span class="iconfont icon-twitter"></span>&nbsp;@jacopoj_</a><a class="item" href="https://www.linkedin.com/in/jacopoj" target="_blank"><span class="iconfont icon-linkedin"></span>&nbsp;jacopoj</a><a class="item" href="https://jacopo.io/contact/?type=blog&amp;locale=it" target="_blank"><span class="iconfont icon-email"></span>&nbsp;E-mail</a><a class="item" href="/it/post/index.xml" target="_blank"><span class="iconfont icon-rss"></span>&nbsp;RSS</a></div><p class="copyright">© 2018-2024 <a href='https://jacopo.io' target='_blank'>Jacopo Jannone</a></p></div>
</section></body>

</html>